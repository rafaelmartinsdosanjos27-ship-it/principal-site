<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Painel Admin - Rafael Services</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white p-8">
    <div id="admin-content" class="hidden max-w-4xl mx-auto">
        <div class="flex justify-between items-center mb-10">
            <h1 class="text-3xl font-black italic">CONSULTA DE <span class="text-blue-500">PIX</span></h1>
            <button onclick="location.reload()" class="bg-blue-600 px-4 py-2 rounded-lg font-bold text-xs">ATUALIZAR LISTA</button>
        </div>
        <div class="bg-slate-800 rounded-3xl p-6 border border-slate-700 shadow-2xl">
            <table class="w-full text-left">
                <thead>
                    <tr class="border-b border-slate-700 text-slate-400 text-xs uppercase">
                        <th class="p-4">Cliente</th>
                        <th class="p-4">E-mail</th>
                        <th class="p-4">Data/Hora</th>
                        <th class="p-4">Status</th>
                    </tr>
                </thead>
                <tbody id="tabela-pedidos">
                    </tbody>
            </table>
        </div>
    </div>
    <div id="login-error" class="text-center mt-20">
        <p class="text-red-400 font-bold text-xl mb-4">Acesso Restrito</p>
        <p class="text-slate-500 mb-6">VocÃª precisa estar logado como rafaelmartinsdosanjos27@gmail.com</p>
        <button onclick="location.href='index.html'" class="bg-white text-black px-8 py-3 rounded-full font-black">VOLTAR E LOGAR</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const p1 = "AIzaSyBZW06"; const p2 = "JhscrqiQOBFQ9WsPtg19eCE74INY";
        const firebaseConfig = { apiKey: p1 + p2, authDomain: "site-principal-beb6f.firebaseapp.com", projectId: "site-principal-beb6f", storageBucket: "site-principal-beb6f.firebasestorage.app", messagingSenderId: "1027079340460", appId: "1:1027079340460:web:730dd01b064017cdebba09" };
        
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        onAuthStateChanged(auth, (user) => {
            if (user && user.email === "rafaelmartinsdosanjos27@gmail.com") {
                document.getElementById('admin-content').classList.remove('hidden');
                document.getElementById('login-error').classList.add('hidden');
                
                const q = query(collection(db, "vendas"), orderBy("data", "desc"));
                onSnapshot(q, (snap) => {
                    const lista = document.getElementById('tabela-pedidos');
                    lista.innerHTML = "";
                    snap.forEach(doc => {
                        const v = doc.data();
                        lista.innerHTML += `
                            <tr class="border-b border-slate-700 hover:bg-slate-700/50 transition-all">
                                <td class="p-4 font-bold text-blue-400">${v.nome}</td>
                                <td class="p-4 text-slate-300 text-xs">${v.email}</td>
                                <td class="p-4 text-xs text-slate-500">${new Date(v.data).toLocaleString('pt-BR')}</td>
                                <td class="p-4"><span class="bg-emerald-500/10 text-emerald-500 border border-emerald-500/20 px-3 py-1 rounded-full text-[10px] font-black italic">VERIFICAR PIX</span></td>
                            </tr>`;
                    });
                });
            }
        });
    </script>
</body>
</html>
